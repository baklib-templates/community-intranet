<!-- cruip-mosaic-html/meetups.html -->
{% assign pages = page.pages_in_list | order_by: '-published_at' %}
{% assign pages_count  =  pages | size %}
{% assign default_thumb = 'images/event-thumb.jpg' | asset_url %}

{% unless pages_count > 0 %}
    {% render 'demo_events' %}
{% else %}
    <main class="grow">
        <div class="px-4 sm:px-6 lg:px-8 py-8 w-full max-w-9xl mx-auto">

            <!-- Page header -->
            <div class="sm:flex sm:justify-between sm:items-center mb-5">

                <!-- Page title -->
                <div class="mb-5">
                    <h1 class="flex items-center text-2xl md:text-4xl text-gray-800 font-bold">
                        <img src="{{ page.settings.icon | default: '👏'}}" class="w-10 h-10 mr-2"/>
                        {{ page.link_text }}</h1>
                    <p class="text-sm text-gray-600 mt-2">{{ page.settings.description }}</p>
                </div>

                <!-- Right: Actions -->
                <div class="grid grid-flow-col sm:auto-cols-max justify-start sm:justify-end gap-2">

                    <!-- Search form -->
                    {% form_tag 'search', class: 'relative' %}
                        <label for="action-search" class="sr-only">Search</label>
                        <input type="search" name="{{form.keywords_field_name}}" value="{{ search.keywords | escape_once }}" id="action-search" class="form-input pl-9 bg-white dark:bg-gray-800 dark:text-white" placeholder="">
                        <button class="absolute inset-0 right-auto group" type="submit" aria-label="Search">
                            <svg class="shrink-0 fill-current text-gray-400 dark:text-gray-500 group-hover:text-gray-500 dark:group-hover:text-gray-400 ml-3 mr-2"
                                width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M7 14c-3.86 0-7-3.14-7-7s3.14-7 7-7 7 3.14 7 7-3.14 7-7 7zM7 2C4.243 2 2 4.243 2 7s2.243 5 5 5 5-2.243 5-5-2.243-5-5-5z">
                                </path>
                                <path
                                    d="M15.707 14.293L13.314 11.9a8.019 8.019 0 01-1.414 1.414l2.393 2.393a.997.997 0 001.414 0 .999.999 0 000-1.414z">
                                </path>
                            </svg>
                        </button>
                    {% endform_tag %}

                    <!-- Add meetup button -->
                    <button
                        class="btn bg-gray-900 text-gray-100 hover:bg-gray-800">
                        <svg class="fill-current shrink-0 xs:hidden" width="16" height="16" viewBox="0 0 16 16">
                            <path
                                d="M15 7H9V1c0-.6-.4-1-1-1S7 .4 7 1v6H1c-.6 0-1 .4-1 1s.4 1 1 1h6v6c0 .6.4 1 1 1s1-.4 1-1V9h6c.6 0 1-.4 1-1s-.4-1-1-1z">
                            </path>
                        </svg>
                        <span class="max-xs:sr-only">添加活动</span>
                    </button>

                </div>

            </div>

            <!-- Filters -->
            <div class="mb-5">
                <ul class="flex flex-wrap -m-1">
                    <li
                        class="pb-3 mr-6 last:mr-0 first:pl-4 sm:first:pl-6 lg:first:pl-8 last:pr-4 sm:last:pr-6 lg:last:pr-8">
                        <a class="{% unless params['tag'] %} text-primary underline {% endunless %} whitespace-nowrap" href="{{ page.path }}">All</a>
                    </li>
                    {% for tag in page.settings.tags %}
                        <li class="pb-3 mr-6 last:mr-0 first:pl-4 sm:first:pl-6 lg:first:pl-8 last:pr-4 sm:last:pr-6 lg:last:pr-8">
                            <a class="{% if tag.name == params['tag'] %} text-primary underline {% endif %} hover:text-gray-600 whitespace-nowrap"
                                href="{{ page.path |  append: '?tag=' |  append: tag.name }}">{{ tag.name }}</a>
                        </li>
                    {% endfor %}

                </ul>
            </div>

            {% paginate_tag pages, per: 12 %}
            <!-- Content -->
            <div class="grid xl:grid-cols-2 gap-6 mb-8">
                {% for item in pages %}
                    {% assign tag_names = item.settings.tags | map: 'name' %}
                    {% if params['tag'] == nil or (params['tag'] and (tag_names contains params['tag'])) %} 
                        <!-- Item 1 -->
                        <article class="flex bg-white dark:bg-gray-800 shadow-sm rounded-xl overflow-hidden">
                            <!-- Image -->
                            <a class="relative block w-24 sm:w-56 xl:sidebar-expanded:w-40 2xl:sidebar-expanded:w-56 shrink-0"
                                href="{{ item.path }}">
                                <img class="absolute object-cover object-center w-full h-full" src="{{ item.settings.thumb_url |  default: default_thumb }}"
                                    width="220" height="236" alt="{{ item.link_text }} 01">
                                <!-- Like button -->
                                <button class="absolute top-0 right-0 mt-4 mr-4">
                                    <div class="text-gray-100 bg-gray-900 bg-opacity-60 rounded-full">
                                        <span class="sr-only">Like</span>
                                        <svg class="h-8 w-8 fill-current" viewBox="0 0 32 32">
                                            <path
                                                d="M22.682 11.318A4.485 4.485 0 0019.5 10a4.377 4.377 0 00-3.5 1.707A4.383 4.383 0 0012.5 10a4.5 4.5 0 00-3.182 7.682L16 24l6.682-6.318a4.5 4.5 0 000-6.364zm-1.4 4.933L16 21.247l-5.285-5A2.5 2.5 0 0112.5 12c1.437 0 2.312.681 3.5 2.625C17.187 12.681 18.062 12 19.5 12a2.5 2.5 0 011.785 4.251h-.003z">
                                            </path>
                                        </svg>
                                    </div>
                                </button>
                            </a>
                            <!-- Content -->
                            <div class="grow p-5 flex flex-col">
                                <div class="grow">
                                    <div class="text-sm font-semibold text-violet-500 uppercase mb-2">{{ item.settings.date |  default: '2024-01-01' }}</div>
                                    <a class="inline-flex mb-2" href="{{ item.path }}">
                                        <h3 class="h4 dark:text-white">{{ item.link_text }}</h3>
                                    </a>
                                    <div class="text-sm dark:text-gray-400">{{ item.settings.description }}</div>
                                </div>
                                <!-- Footer -->
                                <div class="flex justify-between items-center mt-3">
                                    <!-- Tag -->
                                    <div
                                        class="text-xs inline-flex items-center font-medium border border-gray-200 dark:border-gray-700/60 text-gray-600 dark:text-gray-400 rounded-full text-center px-2.5 py-1">
                                        <svg class="w-4 h-3 fill-gray-400 dark:fill-gray-500 mr-2" viewBox="0 0 16 12">
                                            <path
                                                d="m16 2-4 2.4V2a2 2 0 0 0-2-2H2a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V7.6l4 2.4V2ZM2 10V2h8v8H2Z">
                                            </path>
                                        </svg>
                                        <span>{{ item.settings.type.label }}</span>
                                    </div>
                                    <!-- Avatars -->
                                    <div class="flex items-center space-x-2">
                                        <div class="flex -space-x-3 -ml-0.5">
                                            <img class="rounded-full border-2 border-white dark:border-gray-800 box-content"
                                                src="{{ 'images/avatar.svg' | asset_url }}" width="28" height="28" alt="User 01">
                                            <img class="rounded-full border-2 border-white dark:border-gray-800 box-content"
                                                src="{{ 'images/avatar.svg' | asset_url }}" width="28" height="28" alt="User 04">
                                            <img class="rounded-full border-2 border-white dark:border-gray-800 box-content"
                                                src="{{ 'images/avatar.svg' | asset_url }}" width="28" height="28" alt="User 05">
                                        </div>
                                        <div class="text-xs font-medium text-gray-400 dark:text-gray-500 italic">+22</div>
                                    </div>
                                </div>
                            </div>
                        </article>
                    {% endif %}
                {% endfor %}
            </div>

            <!-- Pagination -->
            <div class="mt-8">
                <div class="flex justify-center">
                    {% render 'paginate', paginate: paginate %}
                </div>
            </div>
            {% endpaginate_tag %}

        </div>
    </main>
{% endunless %}

{% schema %}
{
    "name": "Events",
    "description": "活动会议栏目",
    "thumb_url": "images/theme/events.png",
    "sub_page_templates": ["page"],
    "settings": [
        {
            "id": "description",
            "type": "textarea",
            "label": "描述"
        },
        {
            "id": "tags",
            "type": "tag_picker",
            "multiple": true,
            "label": "标签"
        },
        {
            "id": "thumb_image_url",
            "type": "image_picker",
            "ratio": "4:1",
            "width": 640,
            "label": "主页封面"
        },
        {
            "id": "icon",
            "type": "image_picker",
            "ratio": "1:1",
            "width": 100,
            "label": "图标"
        }
    ]
}
{% endschema %}
